
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Potential field transformations (fatiando.gravmag.transform) &#8212; Fatiando dev</title>
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
    <link rel="stylesheet" href="../_static/style.css" type="text/css" />
    <link rel="stylesheet" href="../_static/font-awesome/css/font-awesome.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     'ac2afbcb2d99b18f145cc1ed40075beb5f92dd5a',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />

    
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">


    <meta name="twitter:card" content="summary">
    <meta name="twitter:image" content="http://www.fatiando.org/_static/fatiando-logo.png">
    <meta name="twitter:site" content="@leouieda">
    <meta name="twitter:title" content="Fatiando a Terra">
    <meta name="twitter:description" content="Open-source Python library for geophysics">

    <meta property="og:title" content="Fatiando a Terra">
    <meta property="og:type" content="website">
    <meta property="og:url" content="http://www.fatiando.org/">
    <meta property="og:site_name" content="Fatiando a Terra">
    <meta property="og:image" content="http://www.fatiando.org/_static/fatiando-logo.png">
    <meta property="og:description" content="Open-source Python library for geophysics">

    <!-- Google Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-38125837-1', 'auto');
    ga('send', 'pageview');
    </script>


  </head>
  <body>

    
        <div class="container-fluid" style="margin: 0px; padding: 0px;">
            <div class="alert alert-dismissible alert-warning text-center dev-version-warning">
                <button type="button" class="close" data-dismiss="alert">×</button>
                This page reflects the <strong>development version</strong>
                (<a href="https://github.com/fatiando/fatiando"><em>master</em> branch
                  on Github</a>).
                Go to <a href="http://www.fatiando.org">fatiando.org</a> for the latest
                release.
            </div>
        </div>
    

    


    
<div class="container-fluid menu text-center">
    <div class="col-lg-3 menu-brand">
        <a class="" href="../index.html">
            
                <img src="../_static/fatiando-navbar-logo.png">
            
            
                fatiando
            
        </a>
        <span class="menu-version">dev</span>
    </div>
    <div class="col-lg-6 menu-list">
        <ul>
            
                    <li><a href="../install.html">Install</a></li>
                    <li><a href="../gallery/index.html">Gallery</a></li>
                    <li><a href="../api.html">API</a></li>
                    <li><a href="../docs.html">Docs</a></li>
                    <li><a href="../develop.html">Contribute</a></li>
                    <li><a href="../cite.html">Cite</a></li>
                    <li><a href="https://github.com/fatiando/fatiando"><i class="fa fa-github fa-lg" title="Source code on Github"></i></a></li>
            
        </ul>
    </div>
    <div class="col-lg-3 menu-search">
        
            
<form class="navbar-form" action="../search.html" method="get">
    <div class="form-group">
        <input type="text" name="q" class="form-control" placeholder="Search" />
    </div>
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
</form>
        
    </div>
</div>


    

        <div class="container page-container">
            <div class="row">
                
      <div class="col-md-3">
        <div id="sidebar" class="bs-sidenav" role="complementary"><ul>
<li><a class="reference internal" href="#">Potential field transformations (<code class="docutils literal"><span class="pre">fatiando.gravmag.transform</span></code>)</a></li>
</ul>

        </div>
      </div>
                <div class="col-md-9 content">
                    <div class="section" id="module-fatiando.gravmag.transform">
<span id="potential-field-transformations-fatiando-gravmag-transform"></span><span id="fatiando-gravmag-transform"></span><h1>Potential field transformations (<code class="docutils literal"><span class="pre">fatiando.gravmag.transform</span></code>)<a class="headerlink" href="#module-fatiando.gravmag.transform" title="Permalink to this headline">¶</a></h1>
<p>Potential field transformations, like upward continuation and derivatives.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Most, if not all, functions here required gridded data.</p>
</div>
<p><strong>Transformations</strong></p>
<ul class="simple">
<li><a class="reference internal" href="#fatiando.gravmag.transform.upcontinue" title="fatiando.gravmag.transform.upcontinue"><code class="xref py py-func docutils literal"><span class="pre">upcontinue</span></code></a>: Upward continuation of
gridded potential field data on a level surface.</li>
<li><a class="reference internal" href="#fatiando.gravmag.transform.reduce_to_pole" title="fatiando.gravmag.transform.reduce_to_pole"><code class="xref py py-func docutils literal"><span class="pre">reduce_to_pole</span></code></a>: Reduce the total field
magnetic anomaly to the pole.</li>
<li><a class="reference internal" href="#fatiando.gravmag.transform.tga" title="fatiando.gravmag.transform.tga"><code class="xref py py-func docutils literal"><span class="pre">tga</span></code></a>: Calculate the amplitude of the
total gradient (also called the analytic signal)</li>
<li><a class="reference internal" href="#fatiando.gravmag.transform.tilt" title="fatiando.gravmag.transform.tilt"><code class="xref py py-func docutils literal"><span class="pre">tilt</span></code></a>: Calculates the tilt angle</li>
<li><a class="reference internal" href="#fatiando.gravmag.transform.power_density_spectra" title="fatiando.gravmag.transform.power_density_spectra"><code class="xref py py-func docutils literal"><span class="pre">power_density_spectra</span></code></a>: Calculates
the Power Density Spectra of a gridded potential field data.</li>
<li><code class="xref py py-func docutils literal"><span class="pre">radial_average</span></code>: Calculates the
the radial average of a Power Density Spectra using concentring rings.</li>
</ul>
<p><strong>Derivatives</strong></p>
<ul class="simple">
<li><a class="reference internal" href="#fatiando.gravmag.transform.derivx" title="fatiando.gravmag.transform.derivx"><code class="xref py py-func docutils literal"><span class="pre">derivx</span></code></a>: Calculate the n-th order
derivative of a potential field in the x-direction (North-South)</li>
<li><a class="reference internal" href="#fatiando.gravmag.transform.derivy" title="fatiando.gravmag.transform.derivy"><code class="xref py py-func docutils literal"><span class="pre">derivy</span></code></a>: Calculate the n-th order
derivative of a potential field in the y-direction (East-West)</li>
<li><a class="reference internal" href="#fatiando.gravmag.transform.derivz" title="fatiando.gravmag.transform.derivz"><code class="xref py py-func docutils literal"><span class="pre">derivz</span></code></a>: Calculate the n-th order
derivative of a potential field in the z-direction</li>
</ul>
<hr class="docutils" />
<dl class="function">
<dt id="fatiando.gravmag.transform.derivx">
<code class="descclassname">fatiando.gravmag.transform.</code><code class="descname">derivx</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>data</em>, <em>shape</em>, <em>order=1</em>, <em>method='fd'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fatiando/gravmag/transform.html#derivx"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fatiando.gravmag.transform.derivx" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the derivative of a potential field in the x direction.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Requires gridded data.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">If the data is not in SI units, the derivative will be in
strange units! I strongly recommend converting the data to SI
<strong>before</strong> calculating the derivative (use one of the unit conversion
functions of <a class="reference internal" href="../api.html#module-fatiando.utils" title="fatiando.utils"><code class="xref py py-mod docutils literal"><span class="pre">fatiando.utils</span></code></a>). This way the derivative will be in
SI units and can be easily converted to what unit you want.</p>
</div>
<p>Parameters:</p>
<ul class="simple">
<li><dl class="first docutils">
<dt>x, y <span class="classifier-delimiter">:</span> <span class="classifier">1D-arrays</span></dt>
<dd>The x and y coordinates of the grid points</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>data <span class="classifier-delimiter">:</span> <span class="classifier">1D-array</span></dt>
<dd>The potential field at the grid points</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>shape <span class="classifier-delimiter">:</span> <span class="classifier">tuple = (nx, ny)</span></dt>
<dd>The shape of the grid</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>order <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd>The order of the derivative</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>method <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd>The method used to calculate the derivatives. Options are:
<code class="docutils literal"><span class="pre">'fd'</span></code> for central finite-differences (more stable) or <code class="docutils literal"><span class="pre">'fft'</span></code>
for the Fast Fourier Transform.</dd>
</dl>
</li>
</ul>
<p>Returns:</p>
<ul class="simple">
<li><dl class="first docutils">
<dt>deriv <span class="classifier-delimiter">:</span> <span class="classifier">1D-array</span></dt>
<dd>The derivative</dd>
</dl>
</li>
</ul>
</dd></dl>

<dl class="function">
<dt id="fatiando.gravmag.transform.derivy">
<code class="descclassname">fatiando.gravmag.transform.</code><code class="descname">derivy</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>data</em>, <em>shape</em>, <em>order=1</em>, <em>method='fd'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fatiando/gravmag/transform.html#derivy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fatiando.gravmag.transform.derivy" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the derivative of a potential field in the y direction.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Requires gridded data.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">If the data is not in SI units, the derivative will be in
strange units! I strongly recommend converting the data to SI
<strong>before</strong> calculating the derivative (use one of the unit conversion
functions of <a class="reference internal" href="../api.html#module-fatiando.utils" title="fatiando.utils"><code class="xref py py-mod docutils literal"><span class="pre">fatiando.utils</span></code></a>). This way the derivative will be in
SI units and can be easily converted to what unit you want.</p>
</div>
<p>Parameters:</p>
<ul class="simple">
<li><dl class="first docutils">
<dt>x, y <span class="classifier-delimiter">:</span> <span class="classifier">1D-arrays</span></dt>
<dd>The x and y coordinates of the grid points</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>data <span class="classifier-delimiter">:</span> <span class="classifier">1D-array</span></dt>
<dd>The potential field at the grid points</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>shape <span class="classifier-delimiter">:</span> <span class="classifier">tuple = (nx, ny)</span></dt>
<dd>The shape of the grid</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>order <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd>The order of the derivative</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>method <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd>The method used to calculate the derivatives. Options are:
<code class="docutils literal"><span class="pre">'fd'</span></code> for central finite-differences (more stable) or <code class="docutils literal"><span class="pre">'fft'</span></code>
for the Fast Fourier Transform.</dd>
</dl>
</li>
</ul>
<p>Returns:</p>
<ul class="simple">
<li><dl class="first docutils">
<dt>deriv <span class="classifier-delimiter">:</span> <span class="classifier">1D-array</span></dt>
<dd>The derivative</dd>
</dl>
</li>
</ul>
</dd></dl>

<dl class="function">
<dt id="fatiando.gravmag.transform.derivz">
<code class="descclassname">fatiando.gravmag.transform.</code><code class="descname">derivz</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>data</em>, <em>shape</em>, <em>order=1</em>, <em>method='fft'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fatiando/gravmag/transform.html#derivz"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fatiando.gravmag.transform.derivz" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the derivative of a potential field in the z direction.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Requires gridded data.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">If the data is not in SI units, the derivative will be in
strange units! I strongly recommend converting the data to SI
<strong>before</strong> calculating the derivative (use one of the unit conversion
functions of <a class="reference internal" href="../api.html#module-fatiando.utils" title="fatiando.utils"><code class="xref py py-mod docutils literal"><span class="pre">fatiando.utils</span></code></a>). This way the derivative will be in
SI units and can be easily converted to what unit you want.</p>
</div>
<p>Parameters:</p>
<ul class="simple">
<li><dl class="first docutils">
<dt>x, y <span class="classifier-delimiter">:</span> <span class="classifier">1D-arrays</span></dt>
<dd>The x and y coordinates of the grid points</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>data <span class="classifier-delimiter">:</span> <span class="classifier">1D-array</span></dt>
<dd>The potential field at the grid points</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>shape <span class="classifier-delimiter">:</span> <span class="classifier">tuple = (nx, ny)</span></dt>
<dd>The shape of the grid</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>order <span class="classifier-delimiter">:</span> <span class="classifier">int</span></dt>
<dd>The order of the derivative</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>method <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd>The method used to calculate the derivatives. Options are:
<code class="docutils literal"><span class="pre">'fft'</span></code> for the Fast Fourier Transform.</dd>
</dl>
</li>
</ul>
<p>Returns:</p>
<ul class="simple">
<li><dl class="first docutils">
<dt>deriv <span class="classifier-delimiter">:</span> <span class="classifier">1D-array</span></dt>
<dd>The derivative</dd>
</dl>
</li>
</ul>
</dd></dl>

<dl class="function">
<dt id="fatiando.gravmag.transform.power_density_spectra">
<code class="descclassname">fatiando.gravmag.transform.</code><code class="descname">power_density_spectra</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>data</em>, <em>shape</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fatiando/gravmag/transform.html#power_density_spectra"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fatiando.gravmag.transform.power_density_spectra" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the Power Density Spectra of a 2D gridded potential field
through the FFT:</p>
<div class="math">
\[\Phi_{\Delta T}(k_x, k_y) = | F\left{\Delta T \right}(k_x, k_y) |^2\]</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Requires gridded data.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">x, y, z and height should be in meters.</p>
</div>
<p>Parameters:</p>
<ul class="simple">
<li><dl class="first docutils">
<dt>x, y <span class="classifier-delimiter">:</span> <span class="classifier">1D-arrays</span></dt>
<dd>The x and y coordinates of the grid points</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>data <span class="classifier-delimiter">:</span> <span class="classifier">1D-array</span></dt>
<dd>The potential field at the grid points</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>shape <span class="classifier-delimiter">:</span> <span class="classifier">tuple = (nx, ny)</span></dt>
<dd>The shape of the grid</dd>
</dl>
</li>
</ul>
<p>Returns:</p>
<ul class="simple">
<li><dl class="first docutils">
<dt>kx, ky <span class="classifier-delimiter">:</span> <span class="classifier">2D-arrays</span></dt>
<dd>The wavenumbers of each Power Density Spectra point</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>pds <span class="classifier-delimiter">:</span> <span class="classifier">2D-array</span></dt>
<dd>The Power Density Spectra of the data</dd>
</dl>
</li>
</ul>
</dd></dl>

<dl class="function">
<dt id="fatiando.gravmag.transform.radial_average_spectrum">
<code class="descclassname">fatiando.gravmag.transform.</code><code class="descname">radial_average_spectrum</code><span class="sig-paren">(</span><em>kx</em>, <em>ky</em>, <em>pds</em>, <em>max_radius=None</em>, <em>ring_width=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fatiando/gravmag/transform.html#radial_average_spectrum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fatiando.gravmag.transform.radial_average_spectrum" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the average of the Power Density Spectra points that falls
inside concentric rings built around the origin of the wavenumber
coordinate system with constant width.</p>
<p>The width of the rings and the inner radius of the biggest ring can be
changed by setting the optional parameters ring_width and max_radius,
respectively.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">To calculate the radially averaged power density spectra
use the outputs of the function power_density_spectra as
input of this one.</p>
</div>
<p>Parameters:</p>
<ul class="simple">
<li><dl class="first docutils">
<dt>kx, ky <span class="classifier-delimiter">:</span> <span class="classifier">2D-arrays</span></dt>
<dd>The wavenumbers arrays in the <cite>x</cite> and <cite>y</cite> directions</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>pds <span class="classifier-delimiter">:</span> <span class="classifier">2D-array</span></dt>
<dd>The Power Density Spectra</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>max_radius <span class="classifier-delimiter">:</span> <span class="classifier">float (optional)</span></dt>
<dd>Inner radius of the biggest ring.
By default it’s set as the minimum of kx.max() and ky.max().
Making it smaller leaves points outside of the averaging,
and making it bigger includes points nearer to the boundaries.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>ring_width <span class="classifier-delimiter">:</span> <span class="classifier">float (optional)</span></dt>
<dd>Width of the rings.
By default it’s set as the largest value of <span class="math">\(\Delta k_x\)</span> and
<span class="math">\(\Delta k_y\)</span>, being them the equidistances of the kx and ky
arrays.
Making it bigger gives more populated averages, and
making it smaller lowers the ammount of points per ring
(use it carefully).</dd>
</dl>
</li>
</ul>
<p>Returns:</p>
<ul class="simple">
<li><dl class="first docutils">
<dt>k_radial <span class="classifier-delimiter">:</span> <span class="classifier">1D-array</span></dt>
<dd>Wavenumbers of each Radially Averaged Power Spectrum point.
Also, the inner radius of the rings.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>pds_radial <span class="classifier-delimiter">:</span> <span class="classifier">1D array</span></dt>
<dd>Radially Averaged Power Spectrum</dd>
</dl>
</li>
</ul>
</dd></dl>

<dl class="function">
<dt id="fatiando.gravmag.transform.reduce_to_pole">
<code class="descclassname">fatiando.gravmag.transform.</code><code class="descname">reduce_to_pole</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>data</em>, <em>shape</em>, <em>inc</em>, <em>dec</em>, <em>sinc</em>, <em>sdec</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fatiando/gravmag/transform.html#reduce_to_pole"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fatiando.gravmag.transform.reduce_to_pole" title="Permalink to this definition">¶</a></dt>
<dd><p>Reduce total field magnetic anomaly data to the pole.</p>
<p>The reduction to the pole if a phase transformation that can be applied to
total field magnetic anomaly data. It “simulates” how the data would be if
<strong>both</strong> the Geomagnetic field and the magnetization of the source were
vertical (<span class="math">\(90^\circ\)</span> inclination) (Blakely, 1996).</p>
<p>This functions performs the reduction in the frequency domain (using the
FFT). The transform filter is (in the frequency domain):</p>
<div class="math">
\[RTP(k_x, k_y) = \frac{|k|}{
    a_1 k_x^2 + a_2 k_y^2 + a_3 k_x k_y +
    i|k|(b_1 k_x + b_2 k_y)}\]</div>
<p>in which <span class="math">\(k_x\)</span> and <span class="math">\(k_y\)</span> are the wave-numbers in the x and y
directions and</p>
<div class="math">
\[\begin{split}|k| = \sqrt{k_x^2 + k_y^2} \\
a_1 = m_z f_z - m_x f_x \\
a_2 = m_z f_z - m_y f_y \\
a_3 = -m_y f_x - m_x f_y \\
b_1 = m_x f_z + m_z f_x \\
b_2 = m_y f_z + m_z f_y\end{split}\]</div>
<p><span class="math">\(\mathbf{m} = (m_x, m_y, m_z)\)</span> is the unit-vector of the total
magnetization of the source and
<span class="math">\(\mathbf{f} = (f_x, f_y, f_z)\)</span> is the unit-vector of the Geomagnetic
field.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Requires gridded data.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The magnetization direction of the anomaly source is crucial to the
reduction-to-the-pole.
<strong>Wrong values of *sinc* and *sdec* will lead to a wrong reduction.</strong></p>
</div>
<p>Parameters:</p>
<ul class="simple">
<li><dl class="first docutils">
<dt>x, y <span class="classifier-delimiter">:</span> <span class="classifier">1d-arrays</span></dt>
<dd>The x, y, z coordinates of each data point.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>data <span class="classifier-delimiter">:</span> <span class="classifier">1d-array</span></dt>
<dd>The total field anomaly data at each point.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>shape <span class="classifier-delimiter">:</span> <span class="classifier">tuple = (nx, ny)</span></dt>
<dd>The shape of the data grid</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>inc, dec <span class="classifier-delimiter">:</span> <span class="classifier">floats</span></dt>
<dd>The inclination and declination of the inducing Geomagnetic field</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>sinc, sdec <span class="classifier-delimiter">:</span> <span class="classifier">floats</span></dt>
<dd>The inclination and declination of the total magnetization of the
anomaly source. The total magnetization is the vector sum of the
induced and remanent magnetization. If there is only induced
magnetization, use the <em>inc</em> and <em>dec</em> of the Geomagnetic field.</dd>
</dl>
</li>
</ul>
<p>Returns:</p>
<ul class="simple">
<li><dl class="first docutils">
<dt>rtp <span class="classifier-delimiter">:</span> <span class="classifier">1d-array</span></dt>
<dd>The data reduced to the pole.</dd>
</dl>
</li>
</ul>
<p>References:</p>
<p>Blakely, R. J. (1996), Potential Theory in Gravity and Magnetic
Applications, Cambridge University Press.</p>
</dd></dl>

<dl class="function">
<dt id="fatiando.gravmag.transform.tga">
<code class="descclassname">fatiando.gravmag.transform.</code><code class="descname">tga</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>data</em>, <em>shape</em>, <em>method='fd'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fatiando/gravmag/transform.html#tga"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fatiando.gravmag.transform.tga" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the total gradient amplitude (TGA).</p>
<p>This the same as the <cite>3D analytic signal</cite> of Roest et al. (1992), but we
prefer the newer, more descriptive nomenclature suggested by Reid (2012).</p>
<p>The TGA is defined as the amplitude of the gradient vector of a potential
field <span class="math">\(T\)</span> (e.g. the magnetic total field anomaly):</p>
<div class="math">
\[TGA = \sqrt{
    \left(\frac{\partial T}{\partial x}\right)^2 +
    \left(\frac{\partial T}{\partial y}\right)^2 +
    \left(\frac{\partial T}{\partial z}\right)^2 }\]</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Requires gridded data.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">If the data is not in SI units, the derivatives will be in
strange units and so will the total gradient amplitude! I strongly
recommend converting the data to SI <strong>before</strong> calculating the
TGA is you need the gradient in Eotvos (use one of the unit conversion
functions of <a class="reference internal" href="../api.html#module-fatiando.utils" title="fatiando.utils"><code class="xref py py-mod docutils literal"><span class="pre">fatiando.utils</span></code></a>).</p>
</div>
<p>Parameters:</p>
<ul class="simple">
<li><dl class="first docutils">
<dt>x, y <span class="classifier-delimiter">:</span> <span class="classifier">1D-arrays</span></dt>
<dd>The x and y coordinates of the grid points</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>data <span class="classifier-delimiter">:</span> <span class="classifier">1D-array</span></dt>
<dd>The potential field at the grid points</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>shape <span class="classifier-delimiter">:</span> <span class="classifier">tuple = (nx, ny)</span></dt>
<dd>The shape of the grid</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>method <span class="classifier-delimiter">:</span> <span class="classifier">string</span></dt>
<dd>The method used to calculate the horizontal derivatives. Options are:
<code class="docutils literal"><span class="pre">'fd'</span></code> for finite-difference (more stable) or <code class="docutils literal"><span class="pre">'fft'</span></code> for the Fast
Fourier Transform. The z derivative is always calculated by FFT.</dd>
</dl>
</li>
</ul>
<p>Returns:</p>
<ul class="simple">
<li><dl class="first docutils">
<dt>tga <span class="classifier-delimiter">:</span> <span class="classifier">1D-array</span></dt>
<dd>The amplitude of the total gradient</dd>
</dl>
</li>
</ul>
<p>References:</p>
<p>Reid, A. (2012), Forgotten truths, myths and sacred cows of Potential
Fields Geophysics - II, in SEG Technical Program Expanded Abstracts 2012,
pp. 1-3, Society of Exploration Geophysicists.</p>
<p>Roest, W., J. Verhoef, and M. Pilkington (1992), Magnetic interpretation
using the 3-D analytic signal, GEOPHYSICS, 57(1), 116-125,
doi:10.1190/1.1443174.</p>
</dd></dl>

<dl class="function">
<dt id="fatiando.gravmag.transform.tilt">
<code class="descclassname">fatiando.gravmag.transform.</code><code class="descname">tilt</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>data</em>, <em>shape</em>, <em>xderiv=None</em>, <em>yderiv=None</em>, <em>zderiv=None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fatiando/gravmag/transform.html#tilt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fatiando.gravmag.transform.tilt" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the potential field tilt, as defined by Miller and Singh (1994)</p>
<div class="math">
\[tilt(f) = tan^{-1}\left(
    \frac{
        \frac{\partial T}{\partial z}}{
        \sqrt{\frac{\partial T}{\partial x}^2 +
              \frac{\partial T}{\partial y}^2}}
    \right)\]</div>
<p>When used on magnetic total field anomaly data, works best if the data is
reduced to the pole.</p>
<p>It’s useful to plot the zero contour line of the tilt to represent possible
outlines of the source bodies. Use matplotlib’s <code class="docutils literal"><span class="pre">pyplot.contour</span></code> or
<code class="docutils literal"><span class="pre">pyplot.tricontour</span></code> for this.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Requires gridded data if <code class="docutils literal"><span class="pre">xderiv</span></code>, <code class="docutils literal"><span class="pre">yderiv</span></code> and <code class="docutils literal"><span class="pre">zderiv</span></code> are not
given.</p>
</div>
<p>Parameters:</p>
<ul class="simple">
<li><dl class="first docutils">
<dt>x, y <span class="classifier-delimiter">:</span> <span class="classifier">1D-arrays</span></dt>
<dd>The x and y coordinates of the grid points</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>data <span class="classifier-delimiter">:</span> <span class="classifier">1D-array</span></dt>
<dd>The potential field at the grid points</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>shape <span class="classifier-delimiter">:</span> <span class="classifier">tuple = (nx, ny)</span></dt>
<dd>The shape of the grid. Ignored if <em>xderiv</em>, <em>yderiv</em> and <em>zderiv</em> are
given.</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>xderiv <span class="classifier-delimiter">:</span> <span class="classifier">1D-array or None</span></dt>
<dd>Optional. Values of the derivative in the x direction.
If <code class="docutils literal"><span class="pre">None</span></code>, will calculated using the default options of
<a class="reference internal" href="#fatiando.gravmag.transform.derivx" title="fatiando.gravmag.transform.derivx"><code class="xref py py-func docutils literal"><span class="pre">derivx</span></code></a></dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>yderiv <span class="classifier-delimiter">:</span> <span class="classifier">1D-array or None</span></dt>
<dd>Optional. Values of the derivative in the y direction.
If <code class="docutils literal"><span class="pre">None</span></code>, will calculated using the default options of
<a class="reference internal" href="#fatiando.gravmag.transform.derivy" title="fatiando.gravmag.transform.derivy"><code class="xref py py-func docutils literal"><span class="pre">derivy</span></code></a></dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>zderiv <span class="classifier-delimiter">:</span> <span class="classifier">1D-array or None</span></dt>
<dd>Optional. Values of the derivative in the z direction.
If <code class="docutils literal"><span class="pre">None</span></code>, will calculated using the default options of
<a class="reference internal" href="#fatiando.gravmag.transform.derivz" title="fatiando.gravmag.transform.derivz"><code class="xref py py-func docutils literal"><span class="pre">derivz</span></code></a></dd>
</dl>
</li>
</ul>
<p>Returns:</p>
<ul class="simple">
<li><dl class="first docutils">
<dt>tilt <span class="classifier-delimiter">:</span> <span class="classifier">1D-array</span></dt>
<dd>The tilt angle of the total field in radians.</dd>
</dl>
</li>
</ul>
<p>References:</p>
<p>Miller, Hugh G, and Vijay Singh. 1994. “Potential Field Tilt — a New
Concept for Location of Potential Field Sources.”
Journal of Applied Geophysics 32 (2–3): 213-17.
doi:10.1016/0926-9851(94)90022-1.</p>
</dd></dl>

<dl class="function">
<dt id="fatiando.gravmag.transform.upcontinue">
<code class="descclassname">fatiando.gravmag.transform.</code><code class="descname">upcontinue</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>data</em>, <em>shape</em>, <em>height</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/fatiando/gravmag/transform.html#upcontinue"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#fatiando.gravmag.transform.upcontinue" title="Permalink to this definition">¶</a></dt>
<dd><p>Upward continuation of potential field data.</p>
<p>Calculates the continuation through the Fast Fourier Transform in the
wavenumber domain (Blakely, 1996):</p>
<div class="math">
\[F\{h_{up}\} = F\{h\} e^{-\Delta z |k|}\]</div>
<p>and then transformed back to the space domain. <span class="math">\(h_{up}\)</span> is the upward
continue data, <span class="math">\(\Delta z\)</span> is the height increase, <span class="math">\(F\)</span> denotes
the Fourier Transform,  and <span class="math">\(|k|\)</span> is the wavenumber modulus.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Requires gridded data.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">x, y, z and height should be in meters.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">It is not possible to get the FFT of a masked grid. The default
<a class="reference internal" href="fatiando.gridder.interp.html#fatiando.gridder.interp" title="fatiando.gridder.interp"><code class="xref py py-func docutils literal"><span class="pre">fatiando.gridder.interp</span></code></a> call using minimum curvature will not
be suitable.  Use <code class="docutils literal"><span class="pre">extrapolate=True</span></code> or <code class="docutils literal"><span class="pre">algorithm='nearest'</span></code> to
get an unmasked grid.</p>
</div>
<p>Parameters:</p>
<ul class="simple">
<li><dl class="first docutils">
<dt>x, y <span class="classifier-delimiter">:</span> <span class="classifier">1D-arrays</span></dt>
<dd>The x and y coordinates of the grid points</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>data <span class="classifier-delimiter">:</span> <span class="classifier">1D-array</span></dt>
<dd>The potential field at the grid points</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>shape <span class="classifier-delimiter">:</span> <span class="classifier">tuple = (nx, ny)</span></dt>
<dd>The shape of the grid</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>height <span class="classifier-delimiter">:</span> <span class="classifier">float</span></dt>
<dd>The height increase (delta z) in meters.</dd>
</dl>
</li>
</ul>
<p>Returns:</p>
<ul class="simple">
<li><dl class="first docutils">
<dt>cont <span class="classifier-delimiter">:</span> <span class="classifier">array</span></dt>
<dd>The upward continued data</dd>
</dl>
</li>
</ul>
<p>References:</p>
<p>Blakely, R. J. (1996), Potential Theory in Gravity and Magnetic
Applications, Cambridge University Press.</p>
</dd></dl>

</div>

                </div>
                  
            </div>
        </div>

    


    <footer class="footer">
        <div class="container">
            <p class="pull-right">
                <a href="#">Back to top</a>
                
                    <br/>
                    
<div id="sourcelink">
  <a href="../_sources/api/gravmag.transform.rst.txt"
     rel="nofollow">Source</a>
</div>
                
            </p>

            <p class="text-center">
                &copy; Copyright 2010-2018, Leonardo Uieda.
                Created using <a
                    href="http://sphinx-doc.org/">Sphinx</a> 1.6.7.
            </p>
        </div>
    </footer>


  </body>
</html>